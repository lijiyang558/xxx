var t,e,s,i,r,l;import{o as a,c as o,w as n,g as d,t as u,e as h,n as c,d as p,h as v,k as b,f as y,r as f,a as g,F as m,b as _,i as w,u as S,z as x}from"./index-TkfRNjLx.js";import{m as k,a as $}from"./uv-icon.DBsGXtLZ.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as T}from"./uni-app.es.D2PErhGZ.js";const N={props:{isDot:{type:Boolean,default:!1},value:{type:[Number,String],default:""},show:{type:Boolean,default:!0},max:{type:[Number,String],default:999},type:{type:[String,void 0,null],default:"error"},showZero:{type:Boolean,default:!1},bgColor:{type:[String,null],default:null},color:{type:[String,null],default:null},shape:{type:[String,void 0,null],default:"circle"},numberType:{type:[String,void 0,null],default:"overflow"},offset:{type:Array,default:()=>[]},inverted:{type:Boolean,default:!1},absolute:{type:Boolean,default:!1},...null==(e=null==(t=uni.$uv)?void 0:t.props)?void 0:e.badge}};const B=C({name:"uv-badge",mixins:[k,$,N],computed:{boxStyle:()=>({}),badgeStyle(){const t={};if(this.color&&(t.color=this.color),this.bgColor&&!this.inverted&&(t.backgroundColor=this.bgColor),this.absolute&&(t.position="absolute",this.offset.length)){const e=this.offset[0],s=this.offset[1]||e;t.top=this.$uv.addUnit(e),t.right=this.$uv.addUnit(s)}return t},showValue(){switch(this.numberType){case"overflow":return Number(this.value)>Number(this.max)?this.max+"+":this.value;case"ellipsis":return Number(this.value)>Number(this.max)?"...":this.value;case"limit":return Number(this.value)>999?Number(this.value)>=9999?Math.floor(this.value/1e4*100)/100+"w":Math.floor(this.value/1e3*100)/100+"k":this.value;default:return Number(this.value)}},propsType(){return this.type||"error"}}},[["render",function(t,e,s,i,r,l){const b=v;return t.show&&(0!==Number(t.value)||t.showZero||t.isDot)?(a(),o(b,{key:0,class:h([[t.isDot?"uv-badge--dot":"uv-badge--not-dot",t.inverted&&"uv-badge--inverted","horn"===t.shape&&"uv-badge--horn",`uv-badge--${l.propsType}${t.inverted?"--inverted":""}`],"uv-badge"]),style:c([t.$uv.addStyle(t.customStyle),l.badgeStyle])},{default:n((()=>[d(u(t.isDot?"":l.showValue),1)])),_:1},8,["class","style"])):p("",!0)}],["__scopeId","data-v-d4ba6c2a"]]);const R=C({name:"uv-tabs",emits:["click","change"],mixins:[k,$,{props:{duration:{type:Number,default:300},list:{type:Array,default:()=>[]},lineColor:{type:String,default:"#3c9cff"},activeStyle:{type:[String,Object],default:()=>({color:"#303133"})},inactiveStyle:{type:[String,Object],default:()=>({color:"#606266"})},lineWidth:{type:[String,Number],default:20},lineHeight:{type:[String,Number],default:3},lineBgSize:{type:String,default:"cover"},itemStyle:{type:[String,Object],default:()=>({height:"44px"})},scrollable:{type:Boolean,default:!0},current:{type:[Number,String],default:0},keyName:{type:String,default:"name"},...null==(i=null==(s=uni.$uv)?void 0:s.props)?void 0:i.tabs}}],data:()=>({firstTime:!0,scrollLeft:0,scrollViewWidth:0,lineOffsetLeft:0,tabsRect:{left:0},innerCurrent:0,moving:!1}),watch:{current:{immediate:!0,handler(t,e){t!==this.innerCurrent&&(this.innerCurrent=t,this.$nextTick((()=>{this.resize()})))}},list(){this.$nextTick((()=>{this.resize()}))}},computed:{textStyle(){return t=>{const e={},s=t==this.innerCurrent?this.$uv.addStyle(this.activeStyle):this.$uv.addStyle(this.inactiveStyle);return this.list[t].disabled&&(e.color="#c8c9cc"),this.$uv.deepMerge(s,e)}},propsBadge:()=>N},async mounted(){this.init()},methods:{setLineLeft(){const t=this.list[this.innerCurrent];if(!t)return;let e=this.list.slice(0,this.innerCurrent).reduce(((t,e)=>t+e.rect.width),0),s=this.$uv.getPx(this.lineWidth);this.$uv.test.number(this.lineWidth)&&this.$uv.unit&&(s=this.$uv.getPx(`${this.lineWidth}${this.$uv.unit}`)),this.lineOffsetLeft=e+(t.rect.width-s)/2,this.firstTime&&setTimeout((()=>{this.firstTime=!1}),20)},animation(t,e=0){},clickHandler(t,e){this.$emit("click",{...t,index:e}),t.disabled||(this.innerCurrent!=e&&this.$emit("change",{...t,index:e}),this.innerCurrent=e,this.$nextTick((()=>{this.resize()})))},init(){this.$uv.sleep().then((()=>{this.resize()}))},setScrollLeft(){const t=this.list[this.innerCurrent],e=this.list.slice(0,this.innerCurrent).reduce(((t,e)=>t+e.rect.width),0),s=this.$uv.sys().windowWidth;let i=e-(this.tabsRect.width-t.rect.width)/2-(s-this.tabsRect.right)/2+this.tabsRect.left/2;i=Math.min(i,this.scrollViewWidth-this.tabsRect.width),this.scrollLeft=Math.max(0,i)},resize(){0!==this.list.length&&Promise.all([this.getTabsRect(),this.getAllItemRect()]).then((([t,e=[]])=>{this.tabsRect=t,this.scrollViewWidth=0,e.map(((t,e)=>{this.scrollViewWidth+=t.width,this.list[e].rect=t})),this.setLineLeft(),this.setScrollLeft()}))},getTabsRect(){return new Promise((t=>{this.queryRect("uv-tabs__wrapper__scroll-view").then((e=>t(e)))}))},getAllItemRect(){return new Promise((t=>{const e=this.list.map(((t,e)=>this.queryRect(`uv-tabs__wrapper__nav__item-${e}`,!0)));Promise.all(e).then((e=>t(e)))}))},queryRect(t,e){return new Promise((e=>{this.$uvGetRect(`.${t}`).then((t=>{e(t)}))}))}}},[["render",function(t,e,s,i,r,l){const p=v,x=T(b("uv-badge"),B),k=w,$=S;return a(),o(k,{class:"uv-tabs",style:c([t.$uv.addStyle(t.customStyle)])},{default:n((()=>[y(k,{class:"uv-tabs__wrapper"},{default:n((()=>[f(t.$slots,"left",{},void 0,!0),y(k,{class:"uv-tabs__wrapper__scroll-view-wrapper"},{default:n((()=>[y($,{"scroll-x":t.scrollable,"scroll-left":r.scrollLeft,"scroll-with-animation":"",class:"uv-tabs__wrapper__scroll-view","show-scrollbar":!1,ref:"uv-tabs__wrapper__scroll-view"},{default:n((()=>[y(k,{class:"uv-tabs__wrapper__nav",ref:"uv-tabs__wrapper__nav",style:c({flex:t.scrollable?"":1})},{default:n((()=>[(a(!0),g(m,null,_(t.list,((e,s)=>(a(),o(k,{class:h(["uv-tabs__wrapper__nav__item",[`uv-tabs__wrapper__nav__item-${s}`,e.disabled&&"uv-tabs__wrapper__nav__item--disabled"]]),key:s,onClick:t=>l.clickHandler(e,s),ref_for:!0,ref:`uv-tabs__wrapper__nav__item-${s}`,style:c([{flex:t.scrollable?"":1},t.$uv.addStyle(t.itemStyle)])},{default:n((()=>[y(p,{class:h([[e.disabled&&"uv-tabs__wrapper__nav__item__text--disabled"],"uv-tabs__wrapper__nav__item__text"]),style:c([l.textStyle(s)])},{default:n((()=>[d(u(e[t.keyName]),1)])),_:2},1032,["class","style"]),y(x,{show:!(!e.badge||!(e.badge.show||e.badge.isDot||e.badge.value)),isDot:e.badge&&e.badge.isDot||l.propsBadge.isDot,value:e.badge&&e.badge.value||l.propsBadge.value,max:e.badge&&e.badge.max||l.propsBadge.max,type:e.badge&&e.badge.type||l.propsBadge.type,showZero:e.badge&&e.badge.showZero||l.propsBadge.showZero,bgColor:e.badge&&e.badge.bgColor||l.propsBadge.bgColor,color:e.badge&&e.badge.color||l.propsBadge.color,shape:e.badge&&e.badge.shape||l.propsBadge.shape,numberType:e.badge&&e.badge.numberType||l.propsBadge.numberType,inverted:e.badge&&e.badge.inverted||l.propsBadge.inverted,customStyle:"margin-left: 4px;"},null,8,["show","isDot","value","max","type","showZero","bgColor","color","shape","numberType","inverted"])])),_:2},1032,["onClick","style","class"])))),128)),y(k,{class:"uv-tabs__wrapper__nav__line",ref:"uv-tabs__wrapper__nav__line",style:c([{width:t.$uv.addUnit(t.lineWidth),transform:`translate(${r.lineOffsetLeft}px)`,transitionDuration:`${r.firstTime?0:t.duration}ms`,height:r.firstTime?0:t.$uv.addUnit(t.lineHeight),background:t.lineColor,backgroundSize:t.lineBgSize}])},null,8,["style"])])),_:1},8,["style"])])),_:1},8,["scroll-x","scroll-left"])])),_:1}),f(t.$slots,"right",{},void 0,!0)])),_:3})])),_:3},8,["style"])}],["__scopeId","data-v-72273209"]]);const z=C({name:"uv-sticky",mixins:[k,$,{props:{offsetTop:{type:[String,Number],default:0},customNavHeight:{type:[String,Number],default:44},disabled:{type:Boolean,default:!1},bgColor:{type:String,default:"transparent"},zIndex:{type:[String,Number],default:""},index:{type:[String,Number],default:""},...null==(l=null==(r=uni.$uv)?void 0:r.props)?void 0:l.sticky}}],data:()=>({cssSticky:!1,stickyTop:0,elId:"",left:0,width:"auto",height:"auto",fixed:!1}),computed:{style(){const t={};return this.disabled?t.position="static":this.cssSticky?(t.position="sticky",t.zIndex=this.uZindex,t.top=this.$uv.addUnit(this.stickyTop)):t.height=this.fixed?this.height+"px":"auto",t.backgroundColor=this.bgColor,this.$uv.deepMerge(t,this.$uv.addStyle(this.customStyle))},stickyContent(){const t={};return this.cssSticky||(t.position=this.fixed?"fixed":"static",t.top=this.stickyTop+"px",t.left=this.left+"px",t.width="auto"==this.width?"auto":this.width+"px",t.zIndex=this.uZindex),t},uZindex(){return this.zIndex?this.zIndex:970}},created(){this.elId=this.$uv.guid()},mounted(){this.init()},methods:{init(){this.getStickyTop(),this.checkSupportCssSticky(),this.cssSticky||!this.disabled&&this.initObserveContent()},initObserveContent(){this.$uvGetRect("#"+this.elId).then((t=>{this.height=t.height,this.left=t.left,this.width=t.width,this.$nextTick((()=>{this.observeContent()}))}))},observeContent(){this.disconnectObserver("contentObserver");const t=x({thresholds:[.95,.98,1]});t.relativeToViewport({top:-this.stickyTop}),t.observe(`#${this.elId}`,(t=>{this.setFixed(t.boundingClientRect.top)})),this.contentObserver=t},setFixed(t){const e=t<=this.stickyTop;this.fixed=e},disconnectObserver(t){const e=this[t];e&&e.disconnect()},getStickyTop(){this.stickyTop=this.$uv.getPx(this.offsetTop)+this.$uv.getPx(this.customNavHeight)},async checkSupportCssSticky(){this.checkCssStickyForH5()&&(this.cssSticky=!0),"android"===this.$uv.os()&&Number(this.$uv.sys().system)>8&&(this.cssSticky=!0),"ios"===this.$uv.os()&&(this.cssSticky=!0)},checkComputedStyle(){},checkCssStickyForH5(){const t=["","-webkit-","-ms-","-moz-","-o-"],e=t.length,s=document.createElement("div");for(let i=0;i<e;i++)if(s.style.position=t[i]+"sticky",""!==s.style.position)return!0;return!1}},unmounted(){this.disconnectObserver("contentObserver")}},[["render",function(t,e,s,i,r,l){const d=w;return a(),o(d,{class:"uv-sticky",id:r.elId,style:c([l.style])},{default:n((()=>[y(d,{style:c([l.stickyContent]),class:"uv-sticky__content"},{default:n((()=>[f(t.$slots,"default",{},void 0,!0)])),_:3},8,["style"])])),_:3},8,["id","style"])}],["__scopeId","data-v-18793e9c"]]);export{R as _,z as a};
