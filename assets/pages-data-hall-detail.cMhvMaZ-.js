import{N as t,o as e,c as s,w as o,n,g as i,t as l,d as a,f as d,h as u,i as c,C as r,l as h,J as f,k as m,a as p,b as y,F as g,u as _,v as w,e as x}from"./index-BnkPbRWe.js";import{_ as k}from"./uni-icons.CBn4UW0X.js";import{r as b}from"./uni-app.es.BNROM5dI.js";import{_ as S}from"./uni-nav-bar.DiL9wk2l.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as v}from"./uni-popup.DptEu7ar.js";import{_ as C}from"./uni-easyinput.CfPLPAmP.js";import{o as j,p as z,f as D}from"./index.t3y0XkbU.js";const F={en:{"uni-countdown.day":"day","uni-countdown.h":"h","uni-countdown.m":"m","uni-countdown.s":"s"},"zh-Hans":{"uni-countdown.day":"天","uni-countdown.h":"时","uni-countdown.m":"分","uni-countdown.s":"秒"},"zh-Hant":{"uni-countdown.day":"天","uni-countdown.h":"時","uni-countdown.m":"分","uni-countdown.s":"秒"}},{t:M}=t(F);const T=I({name:"UniCountdown",emits:["timeup"],props:{showDay:{type:Boolean,default:!0},showHour:{type:Boolean,default:!0},showMinute:{type:Boolean,default:!0},showColon:{type:Boolean,default:!0},start:{type:Boolean,default:!0},backgroundColor:{type:String,default:""},color:{type:String,default:"#333"},fontSize:{type:Number,default:14},splitorColor:{type:String,default:"#333"},day:{type:Number,default:0},hour:{type:Number,default:0},minute:{type:Number,default:0},second:{type:Number,default:0},timestamp:{type:Number,default:0},filterShow:{type:Object,default:()=>({})}},data:()=>({timer:null,syncFlag:!1,d:"00",h:"00",i:"00",s:"00",leftTime:0,seconds:0}),computed:{dayText:()=>M("uni-countdown.day"),hourText:t=>M("uni-countdown.h"),minuteText:t=>M("uni-countdown.m"),secondText:t=>M("uni-countdown.s"),timeStyle(){const{color:t,backgroundColor:e,fontSize:s}=this;return{color:t,backgroundColor:e,fontSize:`${s}px`,width:22*s/14+"px",lineHeight:20*s/14+"px",borderRadius:3*s/14+"px"}},splitorStyle(){const{splitorColor:t,fontSize:e,backgroundColor:s}=this;return{color:t,fontSize:12*e/14+"px",margin:s?4*e/14+"px":""}}},watch:{day(t){this.changeFlag()},hour(t){this.changeFlag()},minute(t){this.changeFlag()},second(t){this.changeFlag()},start:{immediate:!0,handler(t,e){if(t)this.startData();else{if(!e)return;clearInterval(this.timer)}}}},created:function(t){this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.countDown()},unmounted(){clearInterval(this.timer)},methods:{toSeconds:(t,e,s,o,n)=>t?t-parseInt((new Date).getTime()/1e3,10):60*e*60*24+60*s*60+60*o+n,timeUp(){clearInterval(this.timer),this.$emit("timeup")},countDown(){let t=this.seconds,[e,s,o,n]=[0,0,0,0];t>0?(e=Math.floor(t/86400),s=Math.floor(t/3600)-24*e,o=Math.floor(t/60)-24*e*60-60*s,n=Math.floor(t)-24*e*60*60-60*s*60-60*o):this.timeUp(),this.d=String(e).padStart(this.validFilterShow(this.filterShow.d),"0"),this.h=String(s).padStart(this.validFilterShow(this.filterShow.h),"0"),this.i=String(o).padStart(this.validFilterShow(this.filterShow.m),"0"),this.s=String(n).padStart(this.validFilterShow(this.filterShow.s),"0")},validFilterShow:t=>t&&t>0?t:2,startData(){if(this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.seconds<=0)return this.seconds=this.toSeconds(0,0,0,0,0),void this.countDown();clearInterval(this.timer),this.countDown(),this.timer=setInterval((()=>{this.seconds--,this.seconds<0?this.timeUp():this.countDown()}),1e3)},update(){this.startData()},changeFlag(){this.syncFlag||(this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.startData(),this.syncFlag=!0)}}},[["render",function(t,r,h,f,m,p){const y=u,g=c;return e(),s(g,{class:"uni-countdown"},{default:o((()=>[h.showDay?(e(),s(y,{key:0,style:n([p.timeStyle]),class:"uni-countdown__number"},{default:o((()=>[i(l(m.d),1)])),_:1},8,["style"])):a("",!0),h.showDay?(e(),s(y,{key:1,style:n([p.splitorStyle]),class:"uni-countdown__splitor"},{default:o((()=>[i(l(p.dayText),1)])),_:1},8,["style"])):a("",!0),h.showHour?(e(),s(y,{key:2,style:n([p.timeStyle]),class:"uni-countdown__number"},{default:o((()=>[i(l(m.h),1)])),_:1},8,["style"])):a("",!0),h.showHour?(e(),s(y,{key:3,style:n([p.splitorStyle]),class:"uni-countdown__splitor"},{default:o((()=>[i(l(h.showColon?":":p.hourText),1)])),_:1},8,["style"])):a("",!0),h.showMinute?(e(),s(y,{key:4,style:n([p.timeStyle]),class:"uni-countdown__number"},{default:o((()=>[i(l(m.i),1)])),_:1},8,["style"])):a("",!0),h.showMinute?(e(),s(y,{key:5,style:n([p.splitorStyle]),class:"uni-countdown__splitor"},{default:o((()=>[i(l(h.showColon?":":p.minuteText),1)])),_:1},8,["style"])):a("",!0),d(y,{style:n([p.timeStyle]),class:"uni-countdown__number"},{default:o((()=>[i(l(m.s),1)])),_:1},8,["style"]),h.showColon?a("",!0):(e(),s(y,{key:6,style:n([p.splitorStyle]),class:"uni-countdown__splitor"},{default:o((()=>[i(l(p.secondText),1)])),_:1},8,["style"]))])),_:1})}],["__scopeId","data-v-1eccd148"]]);const B=I({data:()=>({info:{},days:0,hours:0,minutes:0,seconds:0,list:[{name:"大",img:"/static/images/login-bg.png"},{name:"小",img:"/static/images/login-bg.png"},{name:"单",img:"/static/images/login-bg.png"},{name:"双",img:"/static/images/login-bg.png"}],clickIndex:[],jifen:"",userInfo:{},type_id:0}),onLoad(t){this.type_id=t.id,this.getLotteryInfos(),this.getInfo()},methods:{getLotteryInfos(){j({type:this.type_id}).then((t=>{this.info=t.data;const{days:e,hours:s,minutes:o,seconds:n}=this.calculateCountdown(1e3*t.data.now.end_time,Date.now());this.days=e,this.hours=s,this.minutes=o,this.seconds=n}))},submitKj(){if(0===this.clickIndex.length)return r({title:"请选择投注类型",icon:"none"});if(!this.jifen)return r({title:"请输入投注积分",icon:"none"});const t={type:this.info.info.id,lottery_id:this.info.now.id,da:this.clickIndex.includes("大")?1:0,xiao:this.clickIndex.includes("小")?1:0,dan:this.clickIndex.includes("单")?1:0,shuang:this.clickIndex.includes("双")?1:0,score:this.jifen};z(t).then((t=>{r({title:t.msg,icon:"none"}),this.getLotteryInfos(),this.getInfo()}))},getInfo(){D().then((t=>{this.userInfo=t.data}))},getclick(t){if(this.clickIndex.length>0){let e=null;for(let s=0;s<this.clickIndex.length;s++)this.clickIndex[s]===t.name&&(e=s);e?this.clickIndex.splice(e,1):this.clickIndex.push(t.name)}else this.clickIndex.push(t.name)},open(){this.$refs.popup.open("bottom")},clickRecord(){h({url:"/pages/mine/sub/clickRecord"})},calculateCountdown(t,e){const s=t-e;if(s<=0)return{days:0,hours:0,minutes:0,seconds:0,finished:!0};let o=Math.floor(s/1e3);const n=Math.floor(o/86400);o%=86400;const i=Math.floor(o/3600);o%=3600;return{days:n,hours:i,minutes:Math.floor(o/60),seconds:Math.floor(o%60),finished:!1}},goBack(){f({delta:1})}}},[["render",function(t,a,r,h,f,I){const j=u,z=b(m("uni-icons"),k),D=c,F=b(m("uni-nav-bar"),S),M=b(m("uni-countdown"),T),B=_,H=b(m("uni-popup"),v),N=b(m("uni-easyinput"),C),R=w;return e(),s(D,{class:"fs-14"},{default:o((()=>[d(F,{"left-icon":"left",rightText:"点击记录",color:"#fff",fixed:"","background-color":"var(--theme-primary-color)",onClickRight:I.clickRecord,onClickLeft:I.goBack},{default:o((()=>[d(D,null,{default:o((()=>[d(j,null,{default:o((()=>[i(l(f.info.info.name),1)])),_:1}),d(z,{class:"ml-5",type:"down",size:"16",color:"#fff"})])),_:1})])),_:1},8,["onClickRight","onClickLeft"]),d(D,{class:"flex-between-center p-10",style:{"border-bottom":"1px solid #eee"}},{default:o((()=>[d(j,null,{default:o((()=>[i("距"+l(f.info.now.qs)+"期截止",1)])),_:1}),d(M,{color:"red","show-day":f.days,"font-size":24,day:f.days,hour:f.hours,minute:f.minutes,second:f.seconds},null,8,["show-day","day","hour","minute","second"])])),_:1}),d(D,{class:"flex-between-center p-10"},{default:o((()=>[d(j,{style:{color:"#888"}},{default:o((()=>[d(j,{style:{color:"var(--theme-primary-color)"}},{default:o((()=>[i("第"+l(f.info.list[0].qs)+"期",1)])),_:1}),i(" "+l(f.info.list[0].size)+","+l(f.info.list[0].oddeven),1)])),_:1}),d(z,{class:"ml-5",type:"down",size:"16",color:"#222",onClick:I.open},null,8,["onClick"])])),_:1}),d(H,{ref:"popup","background-color":"#fff"},{default:o((()=>[d(D,{class:"popup-content p-15",style:{height:"50dvh","border-radius":"4px 4px 0 0"}},{default:o((()=>[d(B,{"scroll-y":"true",style:{height:"100%"}},{default:o((()=>[(e(!0),p(g,null,y(f.info.list,((t,n)=>(e(),s(D,{class:"flex-between-center mb-10"},{default:o((()=>[d(j,{style:{color:"var(--theme-primary-color)"}},{default:o((()=>[i("第 "+l(t.qs)+" 期",1)])),_:2},1024),d(j,{style:{color:"#888"}},{default:o((()=>[i(l(t.size)+","+l(t.oddeven),1)])),_:2},1024)])),_:2},1024)))),256))])),_:1})])),_:1})])),_:1},512),d(D,{class:"grid-container-2",style:{padding:"5px","box-sizing":"border-box",color:"#fff"}},{default:o((()=>[(e(!0),p(g,null,y(f.list,((t,a)=>(e(),s(D,{class:x(["text-center",f.clickIndex.includes(t.name)?"active":""]),key:a,onClick:e=>I.getclick(t),style:n({"background-image":`url(${t.img})`,height:"120px","background-size":"cover",borderRadius:"4px",lineHeight:"120px"})},{default:o((()=>[d(j,null,{default:o((()=>[i(l(t.name),1)])),_:2},1024)])),_:2},1032,["class","onClick","style"])))),128))])),_:1}),d(D,{class:"p-10"},{default:o((()=>[d(D,{class:"mb-10"},{default:o((()=>[i("当前投票 "),d(j,{style:{color:"red"}},{default:o((()=>[i(l(f.clickIndex.toString()),1)])),_:1})])),_:1}),d(D,{class:"mb-10 flex-center"},{default:o((()=>[d(j,null,{default:o((()=>[i("投票积分")])),_:1}),d(D,{class:"ml-10",style:{width:"100px",height:"35px"}},{default:o((()=>[d(N,{type:"number",modelValue:f.jifen,"onUpdate:modelValue":a[0]||(a[0]=t=>f.jifen=t)},null,8,["modelValue"])])),_:1}),d(j,{class:"ml-10"},{default:o((()=>[i("积分")])),_:1})])),_:1})])),_:1}),d(D,{class:"p-10",style:{"border-top":"1px solid #eee"}},{default:o((()=>[d(j,null,{default:o((()=>[i("总共 "),d(j,{style:{color:"red"}},{default:o((()=>[i(l(f.clickIndex.length),1)])),_:1}),i(" 注")])),_:1}),d(j,null,{default:o((()=>[i("总共 "),d(j,{style:{color:"red"}},{default:o((()=>[i(l(f.jifen),1)])),_:1}),i(" 积分")])),_:1})])),_:1}),d(D,{class:"p-10 flex-between-center"},{default:o((()=>[d(j,null,{default:o((()=>[i("可用积分:"+l(f.userInfo.score),1)])),_:1}),d(D,{class:""},{default:o((()=>[d(R,{class:"primary-button",size:"mini",onClick:I.submitKj},{default:o((()=>[i("提交")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-dd86eefe"]]);export{B as default};
