import{k as e,o as s,c as t,w as a,i as l,f as o,g as i,t as n,d as r,m as u,h as d,v as c}from"./index-C3S8Uy7r.js";import{_ as p}from"./uv-icon.pyP65aTn.js";import{r as f}from"./uni-app.es.BwIbfqiV.js";import{_ as m}from"./uni-file-picker.CJTOsAbx.js";import{_}from"./uni-easyinput.C7Lua1qm.js";import{_ as h}from"./uni-popup.DkQeoU0x.js";import{c as g,f as b,t as x,I as y,G as k}from"./index.BBHAxbKh.js";import{_ as v}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-cloud.es.DI52SZ9s.js";import"./uni-icons.aTnwmgHR.js";const{uploadFile:I}=k;const w=v({data:()=>({userInfo:{},BASE_URL:g.BASE_URL,editType:1,imageValue:[],avatar:"",nickname:""}),onLoad(){this.getInfo()},methods:{getInfo(){b().then((e=>{console.log("getUserInfo",e.data),this.userInfo=e.data}))},open(e){this.editType=e,this.nickname=this.userInfo.nickname,this.$refs.popup.open("center")},select(e){const s=e.tempFilePaths[0];I(s).then((e=>{1==e.code&&(this.avatar=e.data.url)}))},progress(e){console.log("上传进度：",e)},success(e){console.log("上传成功")},fail(e){console.log("上传失败：",e),this.$refs.files.clearFiles()},submit(){return 1!==this.editType||this.avatar?2!==this.editType||this.nickname?void y({nickname:2===this.editType?this.nickname:"",avatar:1===this.editType?this.avatar:""}).then((e=>{x(e.msg),1==e.code&&(this.$refs.popup.close(),this.getInfo())})):x("请输入昵称"):x("请上传头像")}}},[["render",function(g,b,x,y,k,v){const I=l,w=u,j=f(e("uv-icon"),p),V=d,T=f(e("uni-file-picker"),m),S=f(e("uni-easyinput"),_),U=c,F=f(e("uni-popup"),h);return s(),t(I,null,{default:a((()=>[o(I,{class:"p-10 bg-white"},{default:a((()=>[o(I,{class:"flex-between-center fs-14 mt-10",style:{"padding-bottom":"8px","border-bottom":"1px solid #e8e8e8"}},{default:a((()=>[o(I,{class:""},{default:a((()=>[i("头像")])),_:1}),o(I,{class:"flex-center",onClick:b[0]||(b[0]=e=>v.open(1))},{default:a((()=>[o(w,{src:k.userInfo.avatar.includes(".png")?k.BASE_URL+k.userInfo.avatar:k.userInfo.avatar,style:{width:"40px",height:"40px","border-radius":"50%"},mode:""},null,8,["src"]),o(j,{class:"ml-10",name:"arrow-right",size:"16"})])),_:1})])),_:1}),o(I,{class:"flex-between-center fs-14 mt-10",style:{"padding-bottom":"8px","border-bottom":"1px solid #e8e8e8"}},{default:a((()=>[o(I,{class:""},{default:a((()=>[i("昵称")])),_:1}),o(I,{class:"flex-center",onClick:b[1]||(b[1]=e=>v.open(2))},{default:a((()=>[o(V,null,{default:a((()=>[i(n(k.userInfo.nickname),1)])),_:1}),o(j,{class:"ml-10",name:"arrow-right",size:"16"})])),_:1})])),_:1}),o(I,{class:"flex-between-center fs-14 mt-10",style:{"padding-bottom":"8px","border-bottom":"1px solid #e8e8e8"}},{default:a((()=>[o(I,{class:""},{default:a((()=>[i("邀请码")])),_:1}),o(V,null,{default:a((()=>[i(n(k.userInfo.invite_code),1)])),_:1})])),_:1}),o(I,{class:"flex-between-center fs-14 mt-10",style:{"padding-bottom":"8px","border-bottom":"1px solid #e8e8e8"}},{default:a((()=>[o(I,{class:""},{default:a((()=>[i("积分")])),_:1}),o(V,null,{default:a((()=>[i(n(k.userInfo.score),1)])),_:1})])),_:1})])),_:1}),o(F,{ref:"popup","background-color":"#fff",borderRadius:"10px"},{default:a((()=>[o(I,{class:"popup-content p-15",style:{width:"70vw"}},{default:a((()=>[1===k.editType?(s(),t(I,{key:0,class:""},{default:a((()=>[o(V,null,{default:a((()=>[i("上传头像")])),_:1}),o(I,{class:"mt-10"},{default:a((()=>[o(T,{ref:"files",modelValue:k.imageValue,"onUpdate:modelValue":b[2]||(b[2]=e=>k.imageValue=e),fileMediatype:"image",limit:"1",onSelect:v.select,onProgress:v.progress,onSuccess:v.success,onFail:v.fail},null,8,["modelValue","onSelect","onProgress","onSuccess","onFail"])])),_:1})])),_:1})):r("",!0),2===k.editType?(s(),t(I,{key:1,class:""},{default:a((()=>[o(V,null,{default:a((()=>[i("修改昵称")])),_:1}),o(I,{class:"mt-10"},{default:a((()=>[o(S,{modelValue:k.nickname,"onUpdate:modelValue":b[3]||(b[3]=e=>k.nickname=e),placeholder:"请输入昵称"},null,8,["modelValue"])])),_:1})])),_:1})):r("",!0),o(I,{class:"",style:{"margin-top":"30px"}},{default:a((()=>[o(U,{class:"primary-button",style:{width:"100%"},size:"mini",onClick:v.submit},{default:a((()=>[i("保存")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},512)])),_:1})}]]);export{w as default};
