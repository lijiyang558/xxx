import{x as t,l as e,y as s,k as a,o as l,c as o,w as r,i,f as n,a as c,b as d,F as u,g as h,d as p,m as g,S as f,u as m,e as y,q as x,t as _,s as S,h as b}from"./index-D0U_9w8I.js";import{_ as k,a as w}from"./uv-sticky.BeCKMTLB.js";import{r as v}from"./uni-app.es.vL0V2sTy.js";import{_ as T}from"./uv-back-top.CCHvtVWP.js";import{c as j,g as z,h as C,i as L,j as M}from"./index.DEsvId-E.js";import{S as D,_ as R}from"./zxdt.Be6x1LkV.js";import{_ as A}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uv-icon.D3-77230.js";const B=A({components:{ScrollTicker:D},data:()=>({current:0,tags:[],list:[],page:1,pageSize:10,loading:!1,noMore:!1,scrollTop:0,customStyle:{fontSize:"24rpx",background:"var(--theme-primary-color)"},iconStyle:{fontSize:"32rpx",color:"#fff"},banner:[],currentTags:0,BASE_URL:j.BASE_URL,newsList:[]}),onPageScroll(t){this.scrollTop=t.scrollTop},onLoad(){z({type:2}).then((t=>{this.banner=t.data})),C().then((t=>{this.tags=t.data,this.loadData()})),L().then((t=>{this.newsList=t.data}))},onPullDownRefresh(){this.page=1,this.loadData((()=>{t()}))},onReachBottom(){console.log("上拉加载"),this.noMore?(console.log("上拉加载停止"),t()):this.loadMore()},methods:{jumpPage(t){e({url:"/pages/xuan-fei/detail?id="+t.id})},async loadData(t){this.loading=!0;try{const e={page:this.page,size:this.pageSize,city_id:this.tags[this.currentTags].id},s=await M(e);1===this.page?this.list=s.data.list:this.list=this.list.concat(s.data.list),s.data.list.length<10&&(this.noMore=!0)}catch(e){console.error("数据加载失败:",e)}finally{this.loading=!1,t&&"function"==typeof t&&t()}},loadMore(){console.log("加载更多"),this.page++,this.loadData()},change(t){this.current=t.detail.current},clickTags({index:t}){this.currentTags=t,this.page=1,this.noMore=!1,this.loadData()}}},[["render",function(t,e,j,z,C,L){const M=g,D=i,A=S,B=f,E=s("ScrollTicker"),P=v(a("uv-tabs"),k),U=v(a("uv-sticky"),w),q=b,F=v(a("uv-back-top"),T),I=m;return l(),o(D,null,{default:r((()=>[n(B,{class:"swiper-box",onChange:L.change,current:C.current},{default:r((()=>[(l(!0),c(u,null,d(C.banner,((t,e)=>(l(),o(A,{key:e},{default:r((()=>[n(D,{class:y(["swiper-item","swiper-item"+e])},{default:r((()=>[n(M,{src:C.BASE_URL+t.image,style:{width:"100%",height:"100%"},mode:""},null,8,["src"])])),_:2},1032,["class"])])),_:2},1024)))),128))])),_:1},8,["onChange","current"]),n(D,{class:"p-10 flex-center mb-10"},{default:r((()=>[n(M,{src:R,style:{width:"106px",height:"64px"},mode:""}),n(D,{class:"",style:{flex:"1"}},{default:r((()=>[n(E,{items:C.newsList},null,8,["items"])])),_:1})])),_:1}),n(U,{bgColor:"var(--theme-primary-color)"},{default:r((()=>[n(P,{style:{background:"var(--theme-primary-color)"},current:C.currentTags,list:C.tags,activeStyle:{color:"red"},inactiveStyle:{color:"#fff"},lineColor:"red",onChange:L.clickTags},null,8,["current","list","onChange"])])),_:1}),n(I,{"scroll-y":"true","show-scrollbar":!1,onScrolltolower:L.loadMore},{default:r((()=>[n(D,{class:"p-10 grid-container-2",style:{"box-sizing":"border-box","grid-template-columns":"repeat(3, 1fr)"}},{default:r((()=>[(l(!0),c(u,null,d(C.list,((t,e)=>(l(),o(D,{class:"",key:e,style:{position:"relative"},onClick:e=>L.jumpPage(t)},{default:r((()=>[x("img",{src:C.BASE_URL+t.images,style:{width:"100%",height:"128px","border-radius":"8px"},alt:""},null,8,["src"]),n(D,{class:"flex-between-center fs-12 bottom-text"},{default:r((()=>[n(q,{style:{display:"block"},class:"ellipsis-text"},{default:r((()=>[h(_(t.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),C.loading?(l(),o(D,{key:0,class:"loading-text text-center text-subtitle fs-14"},{default:r((()=>[h("加载中...")])),_:1})):C.noMore?(l(),o(D,{key:1,class:"no-more-text text-center text-subtitle fs-14"},{default:r((()=>[h("没有更多数据了")])),_:1})):p("",!0),n(F,{"scroll-top":C.scrollTop,customStyle:C.customStyle,iconStyle:C.iconStyle},null,8,["scroll-top","customStyle","iconStyle"])])),_:1},8,["onScrolltolower"])])),_:1})}],["__scopeId","data-v-f2b20f38"]]);export{B as default};
